<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prof. Gladimir Ceroni Catarino</title>
  <meta name="robots" content="noindex, nofollow">
  <style>
    :root {
      --bg: #000;
      --fg: #33ff33;
      --link-dir: #ffcc00;
      --link-file: #00ccff;
    }
    body {
      background-color: var(--bg);
      color: var(--fg);
      font-family: monospace;
      margin: 0; padding: 20px;
    }
    a { color: inherit; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .folder { color: var(--link-dir); }
    .file { color: var(--link-file); }
    .breadcrumb a { color: var(--fg); margin-right: 5px; }
    .breadcrumb span { margin-right: 5px; }
    #temaBtn {
      position: fixed; top: 20px; right: 20px;
      background: none; border: 1px solid var(--fg); color: var(--fg);
      padding: 5px 10px; cursor: pointer; font-family: monospace;
    }
  </style>
</head>
<body>
  <button id="temaBtn">Alternar tema</button>
  <h1><img src="https://gladimircc.github.io/identidade_visual/unisenac_campus_pelotas2.jpg" alt="Logo UniSenac" style="height: 40px; vertical-align: middle;"> Prof. Gladimir Ceroni Catarino</h1>
  <div class="breadcrumb" id="breadcrumb"></div>
  <div><a href="javascript:history.back()">&#x21A9; Voltar</a></div>
  <pre id="listagem"></pre>
  <div id="contador"></div>

  <script>
    const temaBtn = document.getElementById('temaBtn');
    temaBtn.onclick = () => {
      const root = document.documentElement;
      if (root.style.getPropertyValue('--bg') === '#000') {
        root.style.setProperty('--bg', '#fff');
        root.style.setProperty('--fg', '#000');
        temaBtn.textContent = 'Tema escuro';
      } else {
        root.style.setProperty('--bg', '#000');
        root.style.setProperty('--fg', '#33ff33');
        temaBtn.textContent = 'Alternar tema';
      }
    };

    const caminhoAtual = decodeURIComponent(location.pathname.replace(/^\//, '')) || '.';
    const caminhoParts = caminhoAtual.split('/').filter(Boolean);
    const caminhoBase = caminhoParts.join('/') || '.';

    fetch('/files.json')
      .then(r => r.json())
      .then(lista => {
        const pre = document.getElementById('listagem');
        const breadcrumb = document.getElementById('breadcrumb');
        const contador = document.getElementById('contador');

        // gerar breadcrumb naveg√°vel
        let acum = '';
        breadcrumb.innerHTML = '<span>~/</span>';
        caminhoParts.forEach((parte, i) => {
          acum += '/' + parte;
          breadcrumb.innerHTML += `<a href="${acum}/">${parte}</a><span>/</span>`;
        });

        // filtra arquivos da pasta atual
        const visiveis = lista.filter(item => {
          const dir = item.path.replace(/\/g, '/');
          const esperado = caminhoBase === '.' ? !dir.includes('/') : dir.startsWith(caminhoBase + '/') && !dir.slice(caminhoBase.length + 1).includes('/');
          return esperado;
        });

        let pastas = 0, arquivos = 0;
        visiveis.forEach(item => {
          const nomeExibido = item.name;
          if (item.type === 'folder') {
            pastas++;
            pre.innerHTML += `<span class="folder">&#128193; <a href="${item.path}/">${nomeExibido}</a></span>\n`;
          } else {
            arquivos++;
            pre.innerHTML += `<span class="file">&#128196; <a href="/${item.path}">${nomeExibido}</a></span>\n`;
          }
        });

        contador.textContent = `${pastas} pasta(s), ${arquivos} arquivo(s)`;
      });
  </script>
</body>
</html>
